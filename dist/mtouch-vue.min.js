!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).mTouch=e()}(this,function(){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(){}var t=navigator.userAgent,D={tapMaxDistance:5,doubleTapDelay:200,longTapDelay:700,swipeMinDistance:5,swipeTime:300,lockDirection:!0},E={hasTouch:!!("ontouchstart"in window&&{ios:function(){return t.match(/\((i[^;]+);.+OS\s([\d_.]+)/)},android:function(){return t.match(/(Android)[\s/]+([\d.]+)/)},wp:function(){return t.match(/(Windows\s+Phone)\s([\d.]+)/)},getMobile:function(){return this.ios||this.android||this.wp}}.getMobile()),isProxyTarget:function(t,e){return 0===e.indexOf(".")?new RegExp("(\\s|^)".concat(e.substring(1),"(\\s|$)")).test(t.className):0===e.indexOf("#")?t.id===e.substring(1):t.tagName.toLocaleLowerCase()===e},swipeDirection:function(t,e,n,o,i){return D.lockDirection&&"horizontal"===i||!D.lockDirection&&Math.abs(t-n)>=Math.abs(e-o)?n<t?"LEFT":"RIGHT":o<e?"UP":"DOWN"},_trigger:function(t,e,n){var o=n.target,i=e||n.currentTarget||n.target;if(o&&i._m_touch_events[t])for(var a=i._m_touch_events[t];;){if(!o)return;if(o===i)return void this._execHandler(a,t,o,n,!0);var r=a;if(!1===(a=this._execHandler(r,t,o,n,!1)))return;o=o.parentNode}},_execHandler:function(t,e,n,o,i){var a,r,c,u,s,h=[],_=[];for(a=0,r=t.length;a<r;a++)u=(c=t[a]).proxyStr||"",i?u||h.push(c):u&&this.isProxyTarget(n,u)?h.push(c):_.push(c);if(h.length)for(a=0,r=h.length;a<r;a++)if(s=h[a].handler||l,!1===this._callback(e,s,n,o))return!1;return _},_callback:function(t,e,n,o){var i=this.hasTouch?o.touches.length?o.touches[0]:o.changedTouches[0]:o,a=o._m_touch_data||{},r=a.startX||0,c=a.startY||0,u=i.pageX||0,s=i.pageY||0,h={type:t,target:o.target,startX:r,startY:c,pageX:u,pageY:s,moveX:u-r,moveY:s-c,startTime:a.touchStartTime||0,direction:o._m_touch_data?o._m_touch_data.directionLocked:""};o.mTouchEvent=h;var _=e.call(n,o);return!1===_&&(o.preventDefault(),o.stopPropagation()),_},stopFilter:function(e){return function(t){return t.stopPropagation(),e.call(this,t)}},preventFilter:function(e){return function(t){return t.preventDefault(),e.call(this,t)}}},w={TOUCH_START:E.hasTouch?"touchstart":"mousedown",TOUCH_MOVE:E.hasTouch?"touchmove":"mousemove",TOUCH_END:E.hasTouch?"touchend":"mouseup",TOUCH_CANCEL:"touchcancel",TAP:"tap",DOUBLE_TAP:"doubletap",LONG_TAP:"longtap",SWIPE_START:"swipestart",SWIPING:"swiping",SWIPE_END:"swipeend",SWIPE_LEFT:"swipeleft",SWIPE_RIGHT:"swiperight",SWIPE_UP:"swipeup",SWIPE_DOWN:"swipedown",CANCEL:"cancel"};var e=function(){function e(t){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),[].forEach.call(t,function(t,e){t._m_touch_events=t._m_touch_events||{},function(c){if(!c._m_touch_is_bind){var r,n,u,s=0,h=0,t=[],_=t[0],l=t[1],f=t[2],p=t[3],d=!1,g="",m=function(){clearTimeout(r),clearTimeout(n)},T=function(t){d=!1,m(),E._trigger(w.TAP,c,t)},v=function(t){m(),t._m_touch_data={startX:_,startY:f,touchStartTime:s,directionLocked:u},E._trigger(w.CANCEL,c,t)};c.addEventListener(w.TOUCH_START,function(t){var e=E.hasTouch?t.touches[0]:t;_=e.pageX,f=e.pageY,d=!(p=l=0),s=Date.now(),g=u="",t._m_touch_data={startX:_,startY:f,touchStartTime:s,directionLocked:""},E._trigger(w.SWIPE_START,c,t),clearTimeout(n),n=setTimeout(function(){d=!1,m(),E._trigger(w.LONG_TAP,c,t)},D.longTapDelay)}),c.addEventListener(w.TOUCH_MOVE,function(t){if(d){var e=Date.now(),n=E.hasTouch?t.touches[0]:t,o=l||n.pageX,i=p||n.pageY;t._m_touch_data={startX:_,startY:f,touchStartTime:s,directionLocked:""},l=n.pageX,p=n.pageY;var a=Math.abs(_-l),r=Math.abs(f-p);a<D.tapMaxDistance&&r<D.tapMaxDistance||(D.lockDirection&&!u&&(u=r<a?"horizontal":"vertical"),g=E.swipeDirection(o,i,l,p,u),t._m_touch_data.directionLocked=u,m(),E._trigger(w.SWIPING,c,t),300<e-s&&(s=e,t._m_touch_data.touchStartTime=s))}}),c.addEventListener(w.TOUCH_END,function(t){if(d){var e=Date.now(),n=E.hasTouch?t.changedTouches[0]:t;l=n.pageX,p=n.pageY,t._m_touch_data={startX:_,startY:f,touchStartTime:s,directionLocked:u},E._trigger(w.SWIPE_END,c,t);var o=Math.abs(_-l),i=Math.abs(f-p);if(o<=D.tapMaxDistance&&i<=D.tapMaxDistance)h=c._m_touch_events[w.DOUBLE_TAP]&&c._m_touch_events[w.DOUBLE_TAP].length?e-h>D.doubleTapDelay?(r=setTimeout(function(){T(t)},D.doubleTapDelay),e):(m(),E._trigger(w.DOUBLE_TAP,c,t),0):(T(t),e);else if(e-s<=D.swipeTime&&(o>D.swipeMinDistance||i>D.swipeMinDistance)){var a=E.swipeDirection(_,f,l,p,u);m(),a===g?E._trigger(w["SWIPE_".concat(g)],c,t):v(t)}else v(t);d=!1}}),c.addEventListener(w.TOUCH_CANCEL,v),c._m_touch_is_bind=!0}}(t),n[e]=t}),this.length=t.length}return function(t,e,n){e&&o(t.prototype,e),n&&o(t,n)}(e,[{key:"each",value:function(t){for(var e=0,n=this.length;e<n;e++)t.call(this[e],e);return this}},{key:"on",value:function(t,n,o){if("function"==typeof n&&(o=n,n=null),"function"!=typeof o||!t||!t.length)return this;var i=t.split(/\s+/);return this.each(function(){var e=this._m_touch_events;i.forEach(function(t){e[t]||(e[t]=[]),e[t].push({handler:o,proxyStr:n})})}),this}},{key:"off",value:function(i,a,r){return"function"==typeof a&&(r=a,a=null),this.each(function(){var t=this._m_touch_events;if(i){if(t[i]&&t[i].length)if(a||r)for(var e,n=t[i],o=n.length-1;0<=o;)e=n[o],a&&"function"==typeof r?e.proxyStr===a&&e.handler===r&&n.splice(o,1):a&&e.proxyStr===a?n.splice(o,1):"function"==typeof r&&e.handler===r&&n.splice(o,1),o-=1;else t[i]=[]}else this._m_touch_events={}}),this}}],[{key:"config",value:function(t){Object.assign(D,t)}}]),e}(),n={bind:function(t){t._m_touch||(t._m_touch=new e([t]))},inserted:function(){n.update.apply(n,arguments)},update:function(t,e){var n=e.arg,o=t.getAttribute("".concat(n,"-selector")),i=e.value;t["_m_touch_handler_".concat(e.arg)]&&t._m_touch.off(n,o||t["_m_touch_handler_".concat(e.arg)],t["_m_touch_handler_".concat(e.arg)]),n||console.warn("[vue-mtouch] event type argument is required."),"function"!=typeof i&&console.warn("[vue-mtouch] handler must is a function"),e.modifiers.stop&&(i=util.stopFilter(i)),e.modifiers.prevent&&(i=util.preventFilter(i)),t["_m_touch_handler_".concat(e.arg)]=i,t._m_touch.on(n,o,i)},unbind:function(t,e){t["_m_touch_handler_".concat(e.arg)]=null,t._m_touch&&(t._m_touch.off(),t._m_touch=null)}},i={};return i.config=e.config,i.install=function(){Vue.directive("touch",n)},i});
